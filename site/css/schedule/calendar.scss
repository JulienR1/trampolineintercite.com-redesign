@import "../colors";
@import "../variables";

$cellHeight: 50px;
$gridLineWeight: 1px;
$timestampSpacing: 16px;
$overlapReduction: 6%;

tr,
td {
  border-spacing: 0;
  padding: 0;
}

#schedule {
  display: block;
  width: 95%;
  margin: 0 2.5%;
  overflow-y: auto;
  position: relative;

  table {
    width: 100%;

    thead {
      display: flex;

      &::before {
        content: "12:00";
        font-family: "Lato", Arial, Helvetica, sans-serif;
        font-size: 13px;
        padding: 0 $timestampSpacing;
        opacity: 0;
        visibility: hidden;
      }

      tr {
        display: flex;
        width: 100%;

        th {
          flex: 1;
          display: block;
        }
      }
    }

    tbody {
      display: flex;
      overflow-x: hidden;
      padding-top: 0.6em;

      #timestamps {
        td {
          display: block;
          height: $cellHeight;
          position: relative;
          margin-right: calc(#{$timestampSpacing} / 2);

          span {
            display: block;
            font-size: 13px;
            transform: translateY(-0.6em);
            background-color: #fff;
            text-align: center;
            position: relative;
            z-index: 1;
            padding-left: $timestampSpacing;
            padding-right: calc(#{$timestampSpacing} / 2);
          }

          &::after {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 100vw;
            background-color: $lightGray;
            height: $gridLineWeight;
          }
        }
      }

      tr:not(#timestamps) {
        flex: 1;
        border-left: $gridLineWeight solid $lightGray;
        position: relative;
        display: block;

        td {
          display: flex;
          width: 100%;
          height: 100%;

          .activity {
            position: absolute;
            width: 100%;
            top: calc((var(--startTime) - var(--calStart)) * #{$cellHeight});
            height: calc((var(--endTime) - var(--startTime)) * #{$cellHeight});
            padding: 4px 2%;
            overflow-wrap: break-word;
            overflow: hidden;
            background-color: var(--color);
            border-radius: 4px;
            cursor: pointer;

            &::after {
              content: "";
              position: absolute;
              width: 100%;
              height: 5px;
              bottom: 0;
              left: 0;
              background-color: var(--color);
              filter: brightness(87%);
              user-select: none;
            }

            .overlay {
              background-color: #000;
              position: absolute;
              display: block;
              width: 100%;
              height: 100%;
              left: 0;
              top: 0;
              opacity: 0;
              visibility: hidden;
              transition: opacity $shortDelay ease;
            }

            h4 {
              font-size: 15px;
              line-height: 0.85em;
              z-index: 1;
              position: relative;
            }

            span {
              font-size: 12px;
              z-index: 1;
              position: relative;
            }

            &:hover,
            &:active {
              .overlay {
                opacity: 0.1;
                visibility: visible;
              }
            }
          }

          .adjacent,
          .overlap-1,
          .overlap-2,
          .overlap-3 {
            display: block;
            border: 1px solid rgba(255, 255, 255, 0.9);
            z-index: 1;
          }

          .adjacent {
            position: relative;
            flex: 1;
          }

          .overlap-1 {
            width: calc(100% - #{$overlapReduction});
            margin-left: $overlapReduction;
          }

          .overlap-2 {
            width: calc(100% - 2 * #{$overlapReduction});
            margin-left: 2 * $overlapReduction;
          }

          .overlap-3 {
            width: calc(100% - 3 * #{$overlapReduction});
            margin-left: 3 * $overlapReduction;
          }
        }
      }
    }
  }

  #infos {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 3;
    background-color: #fff;
    width: 500px;
    border-radius: 10px;
    overflow: hidden;
    visibility: hidden;
    opacity: 0;
    transition: visibility $shortMediumDelay ease-in-out, opacity $shortMediumDelay ease-in-out;
    user-select: none;

    .left {
      flex: 2;
      margin-bottom: 15px;

      h5 {
        background-color: $hotRed;
        padding: 8px 20px;
        padding-right: 25px;
        font-size: 15px;
        border-bottom-right-radius: 10px;
        width: fit-content;
      }

      p {
        padding: 10px;
        padding-left: 15px;
        padding-bottom: 0;

        i {
          font-size: 14px;
          width: 25px;
          text-align: center;
        }

        span {
          font-size: 14px;
        }
      }
    }

    .right {
      flex: 3;
      padding: 15px;
      padding-left: 0;

      p {
        font-size: 14px;
      }
    }

    &[visible] {
      opacity: 1;
      visibility: visible;
      user-select: initial;
    }
  }
}
